"""crypto_check"""

# imports
import os
import yara

#Path to the folder containing downloaded files in the first part
try:
    RULES_PATH = str(os.getcwd())+ "\\database\\rules\\"
    #Read files
    peid_rules = yara.compile(RULES_PATH + 'peid.yar')
    packer_rules = yara.compile(RULES_PATH + 'packer.yar')
    crypto_rules = yara.compile(RULES_PATH + 'crypto_signatures.yar')
except Exception:
    RULES_PATH = str(os.getcwd())+ "\\V_3" + "\\database\\rules\\"
    #Read files
    peid_rules = yara.compile(RULES_PATH + 'peid.yar')
    packer_rules = yara.compile(RULES_PATH + 'packer.yar')
    crypto_rules = yara.compile(RULES_PATH + 'crypto_signatures.yar')

#Now we will try to find out if yara rules match with the exe
#file, if so that means that yara has detected a packer or a cryptor
#first we try to detect cryptors
def check_exe_path(
    exe_file_path:str="D:\\projects\\malware\\Malware_Behavioural_Based\\V_3\\")\
        ->str:
    """check the folder for cryptors"""
    try:
        #the function match will return the list of detected cryptors
        matches = crypto_rules.match(exe_file_path)
        if matches:
            print('Cryptors detected')
            print(matches)
    except Exception:
        #I always add this exception thing, because I don't know what could happen
        print('No Cryptors detected')
    #detect packers

    try:
        matches = packer_rules.match(exe_file_path)
        if matches:
            print('packers detected')
            print(matches)
    except Exception:
        print('no packer detected')
